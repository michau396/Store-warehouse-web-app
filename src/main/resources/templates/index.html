<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Inventory</title>
</head>
<body>
<h1>Product Inventory</h1>

<a href="/add">Add Product</a> |
<a th:href="@{/products}">Remove filters</a>

<form action="/products" method="get">
    <input type="text" name="name" placeholder="Name" th:value="${name}" />

    <label>Category:</label>
    <select name="category" th:value="${category}">
        <option value="">-- Choose category --</option>
        <option th:each="cat : ${categories}"
                th:value="${cat}"
                th:text="${cat}"
                th:selected="${cat == category}">
        </option>
    </select>

    <input type="text" name="supplier" placeholder="Supplier" th:value="${supplier}" />
    <input type="number" step="0.01" name="minPrice" placeholder="Min Price" th:value="${minPrice}" />
    <input type="number" step="0.01" name="maxPrice" placeholder="Max Price" th:value="${maxPrice}" />
    </select>

    <button type="submit">Filter</button>
</form>

<table border="1">
    <tr>
        <th>
            <a th:href="@{/products(sortBy='id', sortDir=${sortBy == 'id' && sortDir == 'asc' ? 'desc' : 'asc'},
                name=${name}, category=${category}, supplier=${supplier}, minPrice=${minPrice}, maxPrice=${maxPrice}, assignedUserId=${assignedUserId})}">
                ID
            </a>
        </th>
        <th>
            <a th:href="@{/products(sortBy='name', sortDir=${sortBy == 'name' && sortDir == 'asc' ? 'desc' : 'asc'},
                name=${name}, category=${category}, supplier=${supplier}, minPrice=${minPrice}, maxPrice=${maxPrice}, assignedUserId=${assignedUserId})}">
                Name
            </a>
        </th>
        <th>
            <a th:href="@{/products(sortBy='category', sortDir=${sortBy == 'category' && sortDir == 'asc' ? 'desc' : 'asc'},
                name=${name}, category=${category}, supplier=${supplier}, minPrice=${minPrice}, maxPrice=${maxPrice}, assignedUserId=${assignedUserId})}">
                Category
            </a>
        </th>
        <th>
            <a th:href="@{/products(sortBy='quantity', sortDir=${sortBy == 'quantity' && sortDir == 'asc' ? 'desc' : 'asc'},
                name=${name}, category=${category}, supplier=${supplier}, minPrice=${minPrice}, maxPrice=${maxPrice}, assignedUserId=${assignedUserId})}">
                Quantity
            </a>
        </th>
        <th>
            <a th:href="@{/products(sortBy='price', sortDir=${sortBy == 'price' && sortDir == 'asc' ? 'desc' : 'asc'},
                name=${name}, category=${category}, supplier=${supplier}, minPrice=${minPrice}, maxPrice=${maxPrice}, assignedUserId=${assignedUserId})}">
                Price
            </a>
        </th>
        <th>
            <a th:href="@{/products(sortBy='supplier', sortDir=${sortBy == 'supplier' && sortDir == 'asc' ? 'desc' : 'asc'},
        name=${name}, category=${category}, supplier=${supplier}, minPrice=${minPrice}, maxPrice=${maxPrice}, assignedUserId=${assignedUserId})}">
                Supplier
            </a>
        </th>
        <th>
            <a th:href="@{/products(sortBy='expiryDate', sortDir=${sortBy == 'expiryDate' && sortDir == 'asc' ? 'desc' : 'asc'},
        name=${name}, category=${category}, supplier=${supplier}, minPrice=${minPrice}, maxPrice=${maxPrice}, assignedUserId=${assignedUserId})}">
                Expiry Date
            </a>
        </th>
        <th>
            <a th:href="@{/products(sortBy='assignedUser.username', sortDir=${sortBy == 'assignedUser.username' && sortDir == 'asc' ? 'desc' : 'asc'},
                name=${name}, category=${category}, supplier=${supplier}, minPrice=${minPrice}, maxPrice=${maxPrice}, assignedUserId=${assignedUserId})}">
                Assigned User
            </a>
        </th>
        <th>Actions</th>
    </tr>

    <tr th:if="${products.size() == 0}">
        <td colspan="9">Brak wyników.</td> <!-- ✅ Zwiększono colspan -->
    </tr>

    <tr th:each="product : ${products}">
        <td th:text="${product.id}"></td>
        <td th:text="${product.name}"></td>
        <td th:text="${product.category}"></td>
        <td th:text="${product.quantity}"></td>
        <td th:text="${product.price}"></td>
        <td th:text="${product.supplier}"></td> <!-- ✅ Dodano dane dostawcy -->
        <td th:text="${product.expiryDate}"></td>
        <td th:text="${product.assignedUser != null ? product.assignedUser.username : 'Unassigned'}"></td>
        <td>
            <a th:href="@{/edit/{id}(id=${product.id})}">Edit</a> |
            <a th:href="@{/delete/{id}(id=${product.id})}">Delete</a>
        </td>
    </tr>
</table>

<a href="/stats">View Statistics</a>

</body>
</html>





